<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.cjwind.idv.tw","root":"/","scheme":"Gemini","version":"8.0.0-rc.5","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"path":"search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>

  <meta name="description" content="相容性問題使用 library 其中一個目標是不需要重新 compile 就能方便的升級程式的部份功能或者修正 bug。理想上，升級 library 只需要用新的檔案取代舊的。但是事情沒那麼美好，舊程式不見得能正常使用新 library，新舊程式間會有相容性問題。 依據舊程式能不能使用新 library，library 的更新分為相容更新與不相容更新。相容更新通常不修改 interface，可能只">
<meta property="og:type" content="article">
<meta property="og:title" content="Shared Library Versioning">
<meta property="og:url" content="http://www.cjwind.idv.tw/Shared-Library-Versioning/index.html">
<meta property="og:site_name" content="cjwind&#39;s note">
<meta property="og:description" content="相容性問題使用 library 其中一個目標是不需要重新 compile 就能方便的升級程式的部份功能或者修正 bug。理想上，升級 library 只需要用新的檔案取代舊的。但是事情沒那麼美好，舊程式不見得能正常使用新 library，新舊程式間會有相容性問題。 依據舊程式能不能使用新 library，library 的更新分為相容更新與不相容更新。相容更新通常不修改 interface，可能只">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2017-04-03T08:53:36.000Z">
<meta property="article:modified_time" content="2020-08-09T03:17:09.000Z">
<meta property="article:author" content="cjwind">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="System Software">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://www.cjwind.idv.tw/Shared-Library-Versioning/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Shared Library Versioning | cjwind's note</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62800351-2"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-62800351-2');
      }
    </script>






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="cjwind's note" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">cjwind's note</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-projects">

    <a href="/projects/" rel="section"><i class="fa fa-code fa-fw"></i>Projects</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9B%B8%E5%AE%B9%E6%80%A7%E5%95%8F%E9%A1%8C"><span class="nav-number">1.</span> <span class="nav-text">相容性問題</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%88%E8%99%9F"><span class="nav-number">2.</span> <span class="nav-text">版號</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SO-NAME"><span class="nav-number">2.1.</span> <span class="nav-text">SO-NAME</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#link-name"><span class="nav-number">2.2.</span> <span class="nav-text">link name</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Symbol-Versioning"><span class="nav-number">3.</span> <span class="nav-text">Symbol Versioning</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Versioning"><span class="nav-number">3.1.</span> <span class="nav-text">Versioning</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Example"><span class="nav-number">3.1.1.</span> <span class="nav-text">Example</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scoping"><span class="nav-number">3.2.</span> <span class="nav-text">Scoping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GCC-%E5%B0%8D-symbol-version-%E7%9A%84%E6%93%B4%E5%85%85"><span class="nav-number">3.3.</span> <span class="nav-text">GCC 對 symbol version 的擴充</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Semantic-Versioning"><span class="nav-number">4.</span> <span class="nav-text">Semantic Versioning</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Related-posts-amp-Ref"><span class="nav-number">5.</span> <span class="nav-text">Related posts &amp; Ref</span></a></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">cjwind</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">163</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/cjwind" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;cjwind" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:cwentsai@gmail.com" title="E-Mail → mailto:cwentsai@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.youtube.com/channel/UCJCXRf8LQCjX8Ydlrd1i0vw" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCJCXRf8LQCjX8Ydlrd1i0vw" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/chia-wen-tsai-b1605166/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;chia-wen-tsai-b1605166&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>Linkedin</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.cjwind.idv.tw/Shared-Library-Versioning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="cjwind">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="cjwind's note">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shared Library Versioning
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-04-03 16:53:36" itemprop="dateCreated datePublished" datetime="2017-04-03T16:53:36+08:00">2017-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-09 11:17:09" itemprop="dateModified" datetime="2020-08-09T11:17:09+08:00">2020-08-09</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/Shared-Library-Versioning/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="Shared-Library-Versioning/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="相容性問題"><a href="#相容性問題" class="headerlink" title="相容性問題"></a>相容性問題</h2><p>使用 library 其中一個目標是不需要重新 compile 就能方便的升級程式的部份功能或者修正 bug。理想上，升級 library 只需要用新的檔案取代舊的。但是事情沒那麼美好，舊程式不見得能正常使用新 library，新舊程式間會有相容性問題。</p>
<p>依據舊程式能不能使用新 library，library 的更新分為相容更新與不相容更新。相容更新通常不修改 interface，可能只是修正 bug 或者加點新東西。不相容更新則改變了 interface，這時舊版程式無法正常使用新版 library。</p>
<p>library 以 binary 的形式發佈，代表 interface 是 binary 層級，也就是 ABI（Application Binary Layer），包含 call function 的 stack 結構、symbol 命名、memory 配置、參數的結構等等。</p>
<p>ABI 跟語言有很大關係，以 C 語言來說，只要跟 export 的 symbol（function 跟 variable）有關的修改，都會動到 ABI，例如增加 export 變數、增減 export 的 function 參數、修改 export 的資料結構（會改變 memory 配置，程式依舊配置使用新結構會踩壞記憶體）等等。至於 C++ <del>基本上是場災難</del>，因為各家 compiler 甚至相同 compiler 的不同版本可能都對 C++ 的各種特性諸如 virtual function 等有不同實作方式，這會造成 ABI 不相容。C++ 有一些避免改到 interface 的原則及作法，例如 pimpl。</p>
<h2 id="版號"><a href="#版號" class="headerlink" title="版號"></a>版號</h2><p>既然有相容性問題，程式如何知道能不能使用新 library？系統必須有方法確保相容性、讓程式能正常執行，其中一個方法是以版號區分不同版本的 library，並讓程式指定它相容於哪些版本的 library。</p>
<p>在 Linux 系統中，shared library 的檔案命名規則為 <code>libname.so.x.y.z</code>。最前面是字首 <code>lib</code>，中間是 library 名稱，接著 <code>.so</code>，最後跟著三個版號數字。<code>x</code> 表示 major versison number，<code>y</code> 是 minor version number，<code>z</code> 為 release version number。</p>
<p>major version number 代表 library 有重大升級，不同 major version number 的 library 是不相容的。使用舊版的程式必須要經過修改及重新 compile 才能使用新版 library。系統中需要保留舊版 library 以讓未更新至使用新版 library 的程式依然能正常執行。</p>
<p>minor version number 表示 library 是增量升級，也就是加一些新的 interface 並且保持原本的 symbol 在名稱與語意上皆不變，例如增加一個 function。在 major version number 相同的狀況下，高 minor version number 的 library 向後相容低 minor version number 的 library，使用舊版 library 的程式可以使用新版 library，例如使用 <code>1.1.z</code> libary 的程式可以在 <code>1.2.z</code> library 上正常執行。</p>
<p>release version number 是 library 的 bug 修正、效能改進等等，不添加新 interface 也不改動舊 interface。因此相同 major version number 以及 minor version number 的不同 release version 之間的 library 完全相容，依賴某個 release version 的程式可以使用其他任一 release version。</p>
<h3 id="SO-NAME"><a href="#SO-NAME" class="headerlink" title="SO-NAME"></a>SO-NAME</h3><p>library 有版號之後，程式如何指定使用的 library 版本？</p>
<p>在 Solaris 跟 Linux 裡採用 SO-NAME 命名機制，SO-NAME 是 library 版號只保留 major version number，去掉 minor version 以及 release version，例如 <code>libfoo.so.3.2.1</code> 的 SO-NAME 是 <code>libfoo.so.3</code>。</p>
<p>Linux 系統會建立檔名為 SO-NAME 並指向 major version 相同、最新 minor 及 release version 的 library 實體檔案的 soft link，例如 <code>/usr/lib/libcln.so.6</code> 指向 <code>/usr/lib/libcln.so.6.0.4</code>。這麼做的好處是系統中的程式只需要記錄 library 的 SO-NAME，再藉由 soft link 就能使用該 major version 最新的 library。</p>
<p>記錄 SO-NAME 提供了一些彈性，讓 library 有一定的升級空間，不會讓程式只限定於某版本的 library。同時又能知道何種狀況是大幅度的更新，系統不應該自動使用新 major version 的 library，需保留舊版 library 讓使用的程式可以正常執行。當然，話是這麼說，版號只是個規則，還是需要由開發者判斷新版是否向後相容以決定如何升版號。</p>
<p>ELF 在 <code>.dynamic</code> 以 SO-NAME 記錄所需的 shared library：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ readelf -d main</span><br><span class="line">Dynamic section at offset 0x868 contains 26 entries:</span><br><span class="line">  Tag       <span class="built_in"> Type </span>                        Name/Value</span><br><span class="line"><span class="built_in">..</span>.</span><br><span class="line"> 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]</span><br></pre></td></tr></table></figure>

<p>Linux 指令 <code>ldconfig</code> 用來更新上述 library 的 soft link，它會掃過所有預設 shared library directory，例如 <code>/lib</code>、<code>/usr/lib</code> 等，更新所有 soft link，將其指向目前系統中最新的 library 或為新 library 建立 soft link。安裝或更新 library 需要執行 <code>ldconfig</code>。</p>
<h3 id="link-name"><a href="#link-name" class="headerlink" title="link name"></a>link name</h3><p>compile 時我們以 <code>-lXXX</code> 指定要 link 的 library，這個 <code>XXX</code> 稱為 link name。指定 link name 時省略了版號，compiler 會到系統相關的搜尋路徑中尋找最新版本的 <code>XXX</code> library。</p>
<h2 id="Symbol-Versioning"><a href="#Symbol-Versioning" class="headerlink" title="Symbol Versioning"></a>Symbol Versioning</h2><p>SO-NAME 有升級彈性，但仍有問題──假設依賴的 library 是 <code>libfoo.2.3.1</code>，SO-NAME 是 <code>libfoo.2</code>，但執行環境中只有 <code>libfoo.2.2.1</code>，以 SO-NAME 來看是正確的，但卻可能不相容，因為程式可能使用 <code>libfoo.2.3.1</code> 才有的 interface，這在 <code>libfoo.2.2.1</code> 中找不到，因而執行錯誤。這個問題稱為 Minor-revision Rendezvous Problem。</p>
<p>為解決 Minor-revision Rendezvous Problem，Solaris 2.5 發展出 symbol versioning 機制，提供 versioning 以及 scoping 機制。</p>
<h3 id="Versioning"><a href="#Versioning" class="headerlink" title="Versioning"></a>Versioning</h3><p>基本概念是在每個 import 及 export symbol 加上版號，例如 <code>libfoo.1.3</code> 要更新為 <code>libfoo.1.4</code> 時，就把 <code>libfoo.1.4</code> 增加的 symbol 加上 <code>VERS_1.4</code> 的標記。如此 SO-NAME 是 <code>libfoo.1</code> 各版 library 裡會有 <code>VERS_1.2</code>、<code>VERS_1.3</code>、<code>VERS_1.4</code> 等等擁有不同版號標記的 symbol，就能區別 symbol 的版本了。</p>
<p>versioning 定義了一些 symbol 集合。symbol 集合有名稱，例如 <code>VERS_1.2</code>，每個集合包含一些 symbol，一個集合能包含另一個集合，例如 <code>VERS_1.2</code> 包含 <code>VERS_1.1</code>，這種包含關係也像是繼承，<code>VERS_1.2</code> 繼承 <code>VERS_1.1</code> 的 symbol。symbol 集合由 symbol version script 指定，在 <code>gcc</code> 可以用 <code>-Xlinker --version-script &lt;script file&gt;</code> 指定。</p>
<p>versioning 機制讓 symbol 可以標上版號，build 執行檔時會記錄它需要的 symbol 及其版號。因為 symbol 只能有一個 version，在相同 major version 的 library 中，同一個 symbol 的 version 是固定的，否則會導致向後不相容。因此，執行檔執行時可以用 SO-NAME 找到系統中最新的 library，接著看它是不是有所需要版本的 symbol，如果有就能正常執行，以此解決 Minor-revision Rendezvous Problem。</p>
<p>但 Solaris 2.5 的 symbol versioning 有個限制：在一個 shared library 中每個 symbol 只能有一個 version，也就是如果 symbol 是 <code>VERS_1.1</code> 就不能再是 <code>VERS_1.2</code>。這造成如果 interface 只有小修改，例如只加一個參數、依然向後相容（只是擴充，舊有功能不變），由於無法讓新版 library 標示該 symbol 為新版，只能透過增加 major version 來表示 interface 改變，有點小題大作。</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>source code</p>
<figure class="highlight h"><figcaption><span>foo-1.0.h</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><figcaption><span>foo-1.0.c</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> (x + y); &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight h"><figcaption><span>foo-1.1.h</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo2</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><figcaption><span>foo-1.1.c</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> (x + y); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x + x); &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><figcaption><span>main1.c</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;foo-1.0.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, foo(<span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><figcaption><span>main2.c</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;foo-1.1.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, foo(<span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, foo2(<span class="number">12</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><figcaption><span>foo.1.0.ver</span></figcaption><table><tr><td class="code"><pre><span class="line">VERS_1.0 &#123;</span><br><span class="line">    global:</span><br><span class="line">        foo;</span><br><span class="line">    local:</span><br><span class="line">        *;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><figcaption><span>foo.1.1.ver</span></figcaption><table><tr><td class="code"><pre><span class="line">VERS_1.0 &#123;</span><br><span class="line">    global:</span><br><span class="line">        foo;</span><br><span class="line">    local:</span><br><span class="line">        *;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">VERS_1.1 &#123;</span><br><span class="line">    global:</span><br><span class="line">        foo2;</span><br><span class="line">&#125; VERS_1.0;</span><br></pre></td></tr></table></figure>

<p>library 版本更新的時候，可由新的 symbol 集合看出它的 interface 改動，例如上面 <code>1.1</code> 版繼承了 <code>1.0</code> 版、增加了 symbol <code>foo2</code>。</p>
<figure class="highlight makefile"><figcaption><span>Makefile</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="section">1.0:</span></span><br><span class="line">        gcc -shared -fPIC foo-1.0.c -Xlinker --version-script foo.1.0.ver -o libfoo.1.0.so</span><br><span class="line">        rm -f libfoo.so</span><br><span class="line">        ln -s libfoo.1.0.so libfoo.so</span><br><span class="line">        gcc main1.c ./libfoo.so -o main1</span><br><span class="line"></span><br><span class="line"><span class="section">1.1:</span></span><br><span class="line">        gcc -shared -fPIC foo-1.1.c -Xlinker --version-script foo.1.1.ver -o libfoo.1.1.so</span><br><span class="line">        rm -f libfoo.so</span><br><span class="line">        ln -s libfoo.1.1.so libfoo.so</span><br><span class="line">        gcc main2.c ./libfoo.so -o main2</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>看看 library 的 export symbol：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ readelf --dyn-syms libfoo.1.0.so </span><br><span class="line"></span><br><span class="line">Symbol table <span class="string">&#x27;.dynsym&#x27;</span> contains 9 entries:</span><br><span class="line">   Num:    Value          Size<span class="built_in"> Type </span>   Bind   Vis      Ndx Name</span><br><span class="line">     0: 0000000000000000     0 NOTYPE  LOCAL <span class="built_in"> DEFAULT </span> UND </span><br><span class="line">     1: 00000000000004b0     0 SECTION LOCAL <span class="built_in"> DEFAULT </span>  10 </span><br><span class="line">     2: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_deregisterTMCloneTab</span><br><span class="line">     3: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND __gmon_start__</span><br><span class="line">     4: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _Jv_RegisterClasses</span><br><span class="line">     5: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_registerTMCloneTable</span><br><span class="line">     6: 0000000000000000     0 FUNC    WEAK  <span class="built_in"> DEFAULT </span> UND __cxa_finalize@GLIBC_2.2.5 (3)</span><br><span class="line">     7: 0000000000000600    20 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  12 foo@@VERS_1.0</span><br><span class="line">     8: 0000000000000000     0 OBJECT  GLOBAL<span class="built_in"> DEFAULT </span> ABS VERS_1.0</span><br><span class="line"></span><br><span class="line">$ readelf --dyn-syms libfoo.1.1.so </span><br><span class="line"></span><br><span class="line">Symbol table <span class="string">&#x27;.dynsym&#x27;</span> contains 11 entries:</span><br><span class="line">   Num:    Value          Size<span class="built_in"> Type </span>   Bind   Vis      Ndx Name</span><br><span class="line">     0: 0000000000000000     0 NOTYPE  LOCAL <span class="built_in"> DEFAULT </span> UND </span><br><span class="line">     1: 0000000000000528     0 SECTION LOCAL <span class="built_in"> DEFAULT </span>  10 </span><br><span class="line">     2: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_deregisterTMCloneTab</span><br><span class="line">     3: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND __gmon_start__</span><br><span class="line">     4: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _Jv_RegisterClasses</span><br><span class="line">     5: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_registerTMCloneTable</span><br><span class="line">     6: 0000000000000000     0 FUNC    WEAK  <span class="built_in"> DEFAULT </span> UND __cxa_finalize@GLIBC_2.2.5 (4)</span><br><span class="line">     7: 0000000000000680    20 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  12 foo@@VERS_1.0</span><br><span class="line">     8: 0000000000000694    14 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  12 foo2@@VERS_1.1</span><br><span class="line">     9: 0000000000000000     0 OBJECT  GLOBAL<span class="built_in"> DEFAULT </span> ABS VERS_1.0</span><br><span class="line">    10: 0000000000000000     0 OBJECT  GLOBAL<span class="built_in"> DEFAULT </span> ABS VERS_1.1</span><br></pre></td></tr></table></figure>

<p>兩個 library 的 symbol <code>foo</code> 後面加上 <code>VERS</code> 資訊。如果多個 symbol 集合裡有相同 symbol，第一次出現 symbol 的集合是該 symbol 的 version。另外，會被包含的集合必須先寫。也就是說 symbol version 的前後關係是由 version script 指定的，通常遵照數字順序寫（不然會誤導別人啦）。</p>
<p>執行檔可以看到使用的 symbol 版本：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ readelf --dyn-syms main1</span><br><span class="line"></span><br><span class="line">Symbol table <span class="string">&#x27;.dynsym&#x27;</span> contains 8 entries:</span><br><span class="line">   Num:    Value          Size<span class="built_in"> Type </span>   Bind   Vis      Ndx Name</span><br><span class="line">     0: 0000000000000000     0 NOTYPE  LOCAL <span class="built_in"> DEFAULT </span> UND </span><br><span class="line">     1: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_deregisterTMCloneTab</span><br><span class="line">     2: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND foo@VERS_1.0 (2)</span><br><span class="line">     3: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND printf@GLIBC_2.2.5 (3)</span><br><span class="line">     4: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND __libc_start_main@GLIBC_2.2.5 (3)</span><br><span class="line">     5: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND __gmon_start__</span><br><span class="line">     6: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _Jv_RegisterClasses</span><br><span class="line">     7: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_registerTMCloneTable</span><br><span class="line"></span><br><span class="line">$ readelf --dyn-syms main2</span><br><span class="line"></span><br><span class="line">Symbol table <span class="string">&#x27;.dynsym&#x27;</span> contains 9 entries:</span><br><span class="line">   Num:    Value          Size<span class="built_in"> Type </span>   Bind   Vis      Ndx Name</span><br><span class="line">     0: 0000000000000000     0 NOTYPE  LOCAL <span class="built_in"> DEFAULT </span> UND </span><br><span class="line">     1: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND foo2@VERS_1.1 (2)</span><br><span class="line">     2: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_deregisterTMCloneTab</span><br><span class="line">     3: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND foo@VERS_1.0 (3)</span><br><span class="line">     4: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND printf@GLIBC_2.2.5 (4)</span><br><span class="line">     5: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND __libc_start_main@GLIBC_2.2.5 (4)</span><br><span class="line">     6: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND __gmon_start__</span><br><span class="line">     7: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _Jv_RegisterClasses</span><br><span class="line">     8: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_registerTMCloneTable</span><br></pre></td></tr></table></figure>

<p>修改 soft link <code>libfoo.so</code> 指向的 library，<code>main1</code> 依然可以正常使用 <code>1.1</code> 版的 library，但 <code>main2</code> 無法使用 <code>1.0</code> 版的 library，會跳 <code>./main2: ./libfoo.so: version &#39;VERS_1.1&#39; not found (required by ./main2)</code> 找不到 symbol 的 error。</p>
<h3 id="Scoping"><a href="#Scoping" class="headerlink" title="Scoping"></a>Scoping</h3><p>在 symbol 集合裡，<code>local:</code> 的設置會將原本 global 的 symbol 變成 local 的，程式以及其他 shared library 無法使用到這些 symbol。這稱為 scoping 機制，算是補強 ELF 處理 C 的 global symbol scoping，因為 ELF 把所有 global symbol 當作 export symbol，這也是為什麼 Linux 下不需要特別指定哪些 global symbol 要 export 就能 export symbol（windows 就需要）。</p>
<p>上面的例子裡如果把 <code>foo.1.0.ver</code> 裡 <code>local: *;</code> 拿掉，原本其他的 export symbol 就不會被設成 local：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ readelf --dyn-syms libfoo.1.0.so</span><br><span class="line"></span><br><span class="line">Symbol table <span class="string">&#x27;.dynsym&#x27;</span> contains 14 entries:</span><br><span class="line">   Num:    Value          Size<span class="built_in"> Type </span>   Bind   Vis      Ndx Name</span><br><span class="line">     0: 0000000000000000     0 NOTYPE  LOCAL <span class="built_in"> DEFAULT </span> UND</span><br><span class="line">     1: 0000000000000570     0 SECTION LOCAL <span class="built_in"> DEFAULT </span>  10</span><br><span class="line">     2: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_deregisterTMCloneTab</span><br><span class="line">     3: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND __gmon_start__</span><br><span class="line">     4: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _Jv_RegisterClasses</span><br><span class="line">     5: 0000000000000000     0 NOTYPE  WEAK  <span class="built_in"> DEFAULT </span> UND _ITM_registerTMCloneTable</span><br><span class="line">     6: 0000000000000000     0 FUNC    WEAK  <span class="built_in"> DEFAULT </span> UND __cxa_finalize@GLIBC_2.2.5 (3)</span><br><span class="line">     7: 00000000002009b8     0 NOTYPE  GLOBAL<span class="built_in"> DEFAULT </span>  22 _edata</span><br><span class="line">     8: 00000000000006c0    20 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  12 foo@@VERS_1.0</span><br><span class="line">     9: 00000000002009c0     0 NOTYPE  GLOBAL<span class="built_in"> DEFAULT </span>  23 _end</span><br><span class="line">    10: 0000000000000000     0 OBJECT  GLOBAL<span class="built_in"> DEFAULT </span> ABS VERS_1.0</span><br><span class="line">    11: 00000000002009b8     0 NOTYPE  GLOBAL<span class="built_in"> DEFAULT </span>  23 __bss_start</span><br><span class="line">    12: 0000000000000570     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  10 _init</span><br><span class="line">    13: 00000000000006d4     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  13 _fini</span><br></pre></td></tr></table></figure>


<h3 id="GCC-對-symbol-version-的擴充"><a href="#GCC-對-symbol-version-的擴充" class="headerlink" title="GCC 對 symbol version 的擴充"></a>GCC 對 symbol version 的擴充</h3><p>GCC 對於 symbol version 提供兩個擴充。第一個是可以指定 symbol 的 version，例如 <code>asm(&quot;.symver foo_new, foo@VERS_1.1&quot;);</code> 指定 <code>foo_new</code> 是 symbol <code>foo</code> 的 <code>1.1</code> 版。</p>
<p>第二個擴充是允許同個 symbol 有多個版本，這補充了 Solaris 版本機制的限制。例如上面例子裡想在 1.1 版的 <code>foo()</code> 增加一個參數，但希望仍保留舊版功能好能向後相容，這時候就能以指定不同版本來達到。</p>
<figure class="highlight c"><figcaption><span>foo-1.1.c</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">asm</span>(<span class="string">&quot;.symver foo_old, foo@VERS_1.0&quot;</span>);</span><br><span class="line"><span class="keyword">asm</span>(<span class="string">&quot;.symver foo_new, foo@@VERS_1.1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo_old</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> x + y; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo_new</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123; <span class="keyword">return</span> (x + y + z); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x + x); &#125;</span><br></pre></td></tr></table></figure>

<p>兩個 <code>.symver</code> 分別指定 <code>foo_old()</code> 是 <code>foo</code> 的版本 <code>1.0</code>，<code>foo_new()</code> 是版本 <code>1.1</code>。因為已經用 <code>.symver</code> 自訂 <code>foo</code> 這個 symbol，如果又寫 <code>foo()</code> link 時會有 <code>multiple definition</code> 錯誤。<code>foo@@VERS_1.1</code> 表示 <code>foo</code> 預設版本是 <code>1.1</code>，一個 symbol 的預設版號只能有一個，實驗看起來預設版號會影響 compile 執行檔時記錄的 symbol。由於仍然有 <code>1.0</code> 的 <code>foo</code>，<code>main1</code> 用新版 library 仍能正常執行。</p>
<figure class="highlight h"><figcaption><span>foo-1.1.h</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo2</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><figcaption><span>main2.c</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;foo-1.1.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, foo(<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, foo2(<span class="number">12</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>header 跟 library 檔一起發佈，在 compile 執行檔時讓執行檔知道有什麼 symbol，所以必須要是新版 <code>foo</code> 的 prototype，而且 function name 也要是 <code>foo</code>，而非 <code>foo_new</code>。（我想還是有別的方式可以做到同樣的事情，甚至可以刻意使用舊版 symbol，這只是我認為合理的 library 發佈以及使用方式）</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ readelf --dyn-syms libfoo.1.1.so </span><br><span class="line"></span><br><span class="line">Symbol table <span class="string">&#x27;.dynsym&#x27;</span> contains 12 entries:</span><br><span class="line">   Num:    Value          Size<span class="built_in"> Type </span>   Bind   Vis      Ndx Name</span><br><span class="line">     7: 0000000000000690    20 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  12 foo@VERS_1.0</span><br><span class="line">     8: 00000000000006a4    28 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  12 foo@@VERS_1.1</span><br><span class="line">     9: 00000000000006c0    14 FUNC    GLOBAL<span class="built_in"> DEFAULT </span>  12 foo2@@VERS_1.1</span><br><span class="line">    10: 0000000000000000     0 OBJECT  GLOBAL<span class="built_in"> DEFAULT </span> ABS VERS_1.0</span><br><span class="line">    11: 0000000000000000     0 OBJECT  GLOBAL<span class="built_in"> DEFAULT </span> ABS VERS_1.1</span><br><span class="line"></span><br><span class="line">$ readelf --dyn-syms main2</span><br><span class="line"></span><br><span class="line">Symbol table <span class="string">&#x27;.dynsym&#x27;</span> contains 9 entries:</span><br><span class="line">   Num:    Value          Size<span class="built_in"> Type </span>   Bind   Vis      Ndx Name</span><br><span class="line">     1: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND foo2@VERS_1.1 (2)</span><br><span class="line">     6: 0000000000000000     0 FUNC    GLOBAL<span class="built_in"> DEFAULT </span> UND foo@VERS_1.1 (2)</span><br></pre></td></tr></table></figure>


<h2 id="Semantic-Versioning"><a href="#Semantic-Versioning" class="headerlink" title="Semantic Versioning"></a>Semantic Versioning</h2><p>由 <a target="_blank" rel="noopener" href="http://tom.preston-werner.com/">Tom Preston-Werner</a> 提出的 <a target="_blank" rel="noopener" href="http://semver.org/">Semantic Versioning</a> 以 spec 的形式提供了版號規範，例如每個數字代表的意義、何時該增加版號、如何增加版號以及如何區分版本的新舊等等。它定義的版號包含 <code>MAJOR.MINOR.PATCH</code> 三個數字，並且可以加上如 <code>-alpha</code>、<code>-beta</code> 等 pre-release 資訊。概念與上面說的 library 版號類似，interface 有變更時需增加 major verion，增加向後相容的功能時要增加 minor version，修 bug 則增加 patch version，只是它以精準定義的方式描述這些規則。</p>
<p>當然，它只定義了版號本身的規則，至於「什麼改變是有向後相容？是否更改的 interface？」等問題仍然要由開發者判斷。</p>
<h2 id="Related-posts-amp-Ref"><a href="#Related-posts-amp-Ref" class="headerlink" title="Related posts &amp; Ref"></a>Related posts &amp; Ref</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.usenix.org/legacy/publications/library/proceedings/als00/2000papers/papers/full_papers/browndavid/browndavid_html/">Library Interface Versioning in Solaris and Linux</a> / <a target="_blank" rel="noopener" href="https://www.usenix.org/legacy/publications/library/proceedings/als00/2000papers/papers/full_papers/browndavid/browndavid.pdf">pdf</a></li>
<li>《程式設計師的自我修養》ch8</li>
<li><a href="ftp://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_node/ld_25.html">Using LD, the GNU linker - Version Script</a></li>
<li><a target="_blank" rel="noopener" href="http://semver.org/">Semantic Versioning</a></li>
<li><a href="/Dynamic-Linking-Basic/">Dynamic Linking Basic</a></li>
<li><a href="/Dynamic-Linking-PIC/">Dynamic Linking PIC</a></li>
<li><a href="/Dynamic-Linking-Relocation/">Dynamic Linking Relocation</a></li>
<li><a href="/Use-Shared-Library-in-Linux/">Use Shared Library in Linux</a></li>
<li><a href="/Explicit-Runtime-Linking/">Explicit Runtime Linking</a></li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"># Linux</a>
              <a href="/tags/System-Software/" rel="tag"># System Software</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Dynamic-Linking-Relocation/" rel="prev" title="Dynamic Linking Relocation">
      <i class="fa fa-chevron-left"></i> Dynamic Linking Relocation
    </a></div>
      <div class="post-nav-item">
    <a href="/Use-Shared-Library-in-Linux/" rel="next" title="Use Shared Library in Linux">
      Use Shared Library in Linux <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">cjwind</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/next-boot.js"></script>


  




  
<script src="/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://cjwind.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://www.cjwind.idv.tw/Shared-Library-Versioning/";
    this.page.identifier = "Shared-Library-Versioning/";
    this.page.title = "Shared Library Versioning";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://cjwind.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
